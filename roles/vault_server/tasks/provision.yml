---
# tasks/provision.yml - Orchestrator for Configuration Logic

- name: "[PROVISION] 2.1 Enable Authentication Methods"
  ansible.builtin.include_tasks: "provisioning/auth/{{ item }}.yml"
  loop: "{{ vault_enabled_auth_methods | default(['approle']) }}"

- name: "[PROVISION] 2.2 Apply Security Policies (ACLs)"
  ansible.builtin.include_tasks: "provisioning/policies/main.yml"

- name: "[PROVISION] 2.3 Configure Secrets Engines"
  ansible.builtin.include_tasks: "provisioning/engines/{{ item }}.yml"
  loop: "{{ enabled_vault_engines | default([]) }}"

- name: "[PROVISION] 2.4 Configure Application Roles"
  ansible.builtin.include_tasks: "provisioning/roles/{{ item }}.yml"
  loop: "{{ vault_enabled_app_roles | default([]) }}"